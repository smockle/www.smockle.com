<!doctype html><html lang=en><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge,chrome=1"><meta name=viewport content="width=device-width,initial-scale=1"><meta content name=author><meta name=supported-color-schemes content="light dark"><title>Smockle
- Technical Stack II</title><link href=/assets/css/style.css rel=stylesheet><meta name=theme-color content="#26856d"><link rel=icon href=/assets/images/favicon.png><link rel=apple-touch-icon href=/assets/images/apple-touch-icon.png><meta property="og:title" content="Technical Stack II"><meta name=twitter:title content="Technical Stack II"><meta property="og:site_url" content="https://blog.smockle.com/2019/05/05/technical-stack-ii/"><meta property="og:image" content="/assets/images/og-image.png"><meta property="twitter:image" content="/assets/images/twitter-image.png"><meta property="og:type" content="website"><meta name=twitter:card content="summary"></head><body><div class=navigation><section id=wrapper><header class=h-card><a class=u-url href=/><img id=avatar class="u-photo logo" src=/assets/images/smockle.svg width=48 height=48></a></header></section></div><article class="h-entry post"><header><div class=dates><time class=dt-published datetime="2019-05-05 00:00:00 +0000">May 5, 2019</time></div><h1 class=p-name>Technical Stack II</h1></header><section class="e-content post-body"><p>I wrote about the technology used to publish and host this blog in <a href=https://blog.smockle.com/2018/08/22/technical-stack/>“Technical Stack”</a>. In the last week, I’ve moved from building with Jekyll and deploying to GitHub Pages to building with <a href=https://www.gatsbyjs.org>Gatsby</a> and deploying to AWS S3.</p><h3 id=advantages>Advantages</h3><p>Because I no longer use Jekyll, I don’t need to maintain a Ruby environment on my system or in Docker. Dependencies can be upgraded automatically via <a href=https://greenkeeper.io>Greenkeeper</a>, a tool I use for other Node.js projects, rather than via <a href=https://depfu.com>Depfu</a>. My new publishing workflow does not rely on the Dropbox client or API.</p><p>I moved <a href=https://www.smockle.com>my homepage</a> to Gatsby too. This allowed me to share stylesheets, images, and other assets (e.g. <code>robots.txt</code>) between both sites. Gatsby is more flexible than Jekyll about image paths, so images now appear inline in my Markdown editor. Also, I can publish posts and images at the same time.</p><h3 id=workflow>Workflow</h3><p>Federico Viticci writes articles in Markdown and publishes them using Git, the same technologies I use to produce this blog. He has <a href=https://appstories.net/episodes/54/>spoken</a> and <a href=https://www.macstories.net/ios/my-Markdown-writing-and-collaboration-workflow-powered-by-working-copy-3-6-icloud-drive-and-GitHub/>written</a> about his workflow. The tools he uses are powerful, but the publishing process is straightforward. I adopted a similar approach for this blog.</p><p>I write in <a href=https://ia.net/writer>iA Writer</a> on macOS and iOS. My posts are saved in the iA Writer folder in iCloud. Drafts are stored at the top-level. Publishing is a two-step process that begins by dragging a completed post from the top-level into the <code>Published</code> subdirectory. The second step is platform-dependent.</p><p>On macOS, <a href=https://www.noodlesoft.com>Hazel</a> syncs the <code>iA Writer/Published</code> folder in iCloud to a hidden <code>.posts/Published</code> folder<sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup> in a local clone of my Git repository.</p><p>On iOS, <a href=https://workingcopyapp.com>Working Copy</a> bi-directionally syncs the <code>iA Writer/Published</code> folder in iCloud and the <code>.posts/Published</code> folder in my Git repository<sup id=fnref:2><a href=#fn:2 class=footnote-ref role=doc-noteref>2</a></sup>. I can pull, commit and push via a Siri Shortcut.</p><p>Committing and pushing to the GitHub remote will trigger a Travis CI build and deployment. When that completes, the latest files will be uploaded to S3, cached by CloudFront, and viewable here.</p><h3 id=next-steps>Next steps</h3><p>I have several ideas for future improvements:</p><p>Travis CI builds this blog in stages. First, it builds and runs tests. Next, built files are deployed to a pre-production environment where tests are run again. Finally, files are promoted from the pre-production environment to the production environment and tests are run again. The entire process takes sixteen minutes to complete. I’d like it to finish in less than three.</p><p><a href=https://www.gatsbyjs.org/packages/gatsby-plugin-s3/><code>gatsby-plugin-s3</code></a> is a Gatsby plugin for uploading files built with Gatsby to an S3 bucket. Although unofficial, it is actively developed. I haven’t compared <code>gatsby-plugin-s3</code> with my Python-and-Bash deploy script, but I’d like to stop maintaining my own deploy script and the Python environment it requires.</p><p><a href=https://www.gatsbyjs.org/packages/gatsby-remark-vscode/><code>gatsby-remark-vscode</code></a> is a Gatsby plugin for applying syntax highlighting to code blocks from Markdown. It’s very new, but thoughtfully-designed and built by a talented developer I know personally. Here is <a href=https://blog.andrewbran.ch/overengineering-a-blog/>the story behind the development of <code>gatsby-remark-vscode</code></a>.</p><p>Previously, this site could be accessed without an Internet connection. This was accomplished with the <code>ServiceWorker</code> API. Gatsby provides an official plugin for this—<a href=https://www.gatsbyjs.org/packages/gatsby-plugin-offline/><code>gatsby-plugin-offline</code></a>—but I haven’t tried it yet.</p><p>Previously, I used a separate subdomain for this blog (blog.smockle.com). Now, the blog is served from a subdirectory (smockle.com/blog/). I’m still deciding which option better suits current and future content (e.g. apps, podcasts). If I opt to serve content from a subdomain, I’ll need to investigate rewrite rules via Lambda@Edge.</p><section class=footnotes role=doc-endnotes><hr><ol><li id=fn:1 role=doc-endnote><p>Hazel can’t sync deletions unless an entire directory is synced, as documented in <a href=https://www.noodlesoft.com/manual/hazel/advanced-topics/syncing-folders/>“Sync a Subfolder (Including Deletions)”</a>. <a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:2 role=doc-endnote><p>The iA Writer team blogged about this workflow in <a href=https://ia.net/writer/blog/word-and-github>“Word and GitHub”</a>. <a href=#fnref:2 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></section></section></article><footer><div class=post-meta>© 2020 Clay Miller ~ Licensed under
<a rel=license href=http://creativecommons.org/licenses/by/4.0/legalcode>CC-BY-4.0</a> ~ <a href=/feed.xml>RSS</a></div></footer></body></html>